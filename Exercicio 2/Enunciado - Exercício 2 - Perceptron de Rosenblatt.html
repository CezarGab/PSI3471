<!DOCTYPE html>
<!-- saved from url=(0043)https://psi3471.github.io/ex_entrega_2.html -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PSI3471 - Exercício 2 - Perceptron de Rosenblatt</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/quarto-nav.js.download"></script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/headroom.min.js.download"></script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/clipboard.min.js.download"></script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/autocomplete.umd.js.download"></script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/fuse.min.js.download"></script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/quarto-search.js.download"></script>
<meta name="quarto:offset" content="./">
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/quarto.js.download"></script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/popper.min.js.download"></script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/tippy.umd.min.js.download"></script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/anchor.min.js.download"></script>
<link href="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/tippy.css" rel="stylesheet">
<link href="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/bootstrap.min.js.download"></script>
<link href="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/bootstrap-icons.css" rel="stylesheet">
<link href="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/require.min.js.download" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/jquery.min.js.download" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/styles.css">
<style id="quarto-target-style">
      section:target::before {
        content: "";
        display: block;
        height: 61px;
        margin: -61px 0 0;
      }</style></head>

<body class="nav-fixed quarto-light" data-bs-offset="61" style="padding-top: 61px;">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top headroom--top headroom--not-bottom">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="https://psi3471.github.io/">
    <span class="navbar-title">PSI3471</span>
    </a>
  </div>
            <div id="quarto-search" class="type-overlay" title="Search"><div class="aa-Autocomplete" role="combobox" aria-expanded="false" aria-haspopup="listbox"><button type="button" class="aa-DetachedSearchButton"><div class="aa-DetachedSearchButtonIcon"><svg class="aa-SubmitIcon" viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M16.041 15.856c-0.034 0.026-0.067 0.055-0.099 0.087s-0.060 0.064-0.087 0.099c-1.258 1.213-2.969 1.958-4.855 1.958-1.933 0-3.682-0.782-4.95-2.050s-2.050-3.017-2.050-4.95 0.782-3.682 2.050-4.95 3.017-2.050 4.95-2.050 3.682 0.782 4.95 2.050 2.050 3.017 2.050 4.95c0 1.886-0.745 3.597-1.959 4.856zM21.707 20.293l-3.675-3.675c1.231-1.54 1.968-3.493 1.968-5.618 0-2.485-1.008-4.736-2.636-6.364s-3.879-2.636-6.364-2.636-4.736 1.008-6.364 2.636-2.636 3.879-2.636 6.364 1.008 4.736 2.636 6.364 3.879 2.636 6.364 2.636c2.125 0 4.078-0.737 5.618-1.968l3.675 3.675c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414z"></path></svg></div><div class="aa-DetachedSearchButtonPlaceholder">Search</div></button></div></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://psi3471.github.io/" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="https://psi3471.github.io/ex_entrega_2.html#" id="nav-menu-teoria" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Teoria</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teoria">    
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/introducao.html" rel="" target="">
 <span class="dropdown-text">Introdução</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/regressao_linear.html" rel="" target="">
 <span class="dropdown-text">Regressão linear</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/lms.html" rel="" target="">
 <span class="dropdown-text">O algoritmo LMS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/neuronio.html" rel="" target="">
 <span class="dropdown-text">O modelo do neurônio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/mlp.html" rel="" target="">
 <span class="dropdown-text">A rede perceptron multicamada</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/hiperparametros.html" rel="" target="">
 <span class="dropdown-text">Evitando mínimos locais e <em>overfitting</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/medidas.html" rel="" target="">
 <span class="dropdown-text">Medidas de desempenho</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/cnn.html" rel="" target="">
 <span class="dropdown-text">Rede neural convolucional</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="https://psi3471.github.io/ex_entrega_2.html#" id="nav-menu-exercícios-para-aula" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Exercícios para aula</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-exercícios-para-aula">    
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_aula_1.html" rel="" target="">
 <span class="dropdown-text">Exercício 1 - Regressão Linear</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_aula_2.html" rel="" target="">
 <span class="dropdown-text">Exercício 2 - O algoritmo LMS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_aula_3.html" rel="" target="">
 <span class="dropdown-text">Exercício 3 - Neurônio de Rosenblatt no modo mini-batch</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_aula_4.html" rel="" target="">
 <span class="dropdown-text">Exercício 4 - MLP e <em>backpropagation</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_aula_5.html" rel="" target="">
 <span class="dropdown-text">Exercício 5 - MLP e o otimizador Adam</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_aula_6.html" rel="" target="">
 <span class="dropdown-text">Exercício 6 - MLP com PyTorch</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_aula_7.html" rel="" target="">
 <span class="dropdown-text">Exercício 7 - CNN com PyTorch</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="https://psi3471.github.io/ex_entrega_2.html#" id="nav-menu-exercícios-para-entrega" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Exercícios para entrega</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-exercícios-para-entrega">    
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_entrega_1.html" rel="" target="">
 <span class="dropdown-text">Exercício 1 - Regressão Linear</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_entrega_2.html" rel="" target="">
 <span class="dropdown-text">Exercício 2 - Perceptron de Rosenblatt</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_entrega_3.html" rel="" target="">
 <span class="dropdown-text">Exercício 3 - MLP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_entrega_4.html" rel="" target="">
 <span class="dropdown-text">Exercício 4 - CNN</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/ex_avaliacao.html" rel="" target="">
 <span class="dropdown-text">Avaliação - Parte Prática</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="https://psi3471.github.io/ex_entrega_2.html#" id="nav-menu-material-de-apoio" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Material de apoio</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-material-de-apoio">    
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/python_videos.html" rel="" target="">
 <span class="dropdown-text">Tópicos de programação com Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/exemplo_pytorch.html" rel="" target="">
 <span class="dropdown-text">Exemplo MLP com PyTorch</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://psi3471.github.io/exemplo_pytorch_cnn.html" rel="" target="">
 <span class="dropdown-text">Exemplo CNN com PyTorch</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://edisciplinas.usp.br/enrol/index.php?id=106947" rel="" target="">
 <span class="menu-text">Moodle</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" style="min-height: calc(100vh - 61px);">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar" style="top: 61px; max-height: calc(100vh - 61px);">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exercício 2 - Perceptron de Rosenblatt</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="justify">
<p>Um dos experimentos feitos com o perceptron de Rosenblatt consistia na classificação de caracteres. Um caractere era exposto na frente de uma matriz de sensores, que digitalizava a imagem e os elementos dessa matriz eram utilizados como entradas do perceptron, conforme mostrado na fotografia abaixo:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/Rosen_2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Rosenblatt’s Classifier</figcaption>
</figure>
</div>
<p>A ideia consistia em alimentar diversos perceptrons com essas entradas, que funcionariam em paralelo, de forma independente uns dos outros. Cada um era treinado para classificar um determinado caractere, fornecendo saída igual a 1 no caso da detecção do caractere em questão ou -1, no caso da detecção de qualquer outro caractere. Assim, era possível obter uma estrutura com várias saídas, cada uma representando o reconhecimento de um determinado caractere.</p>
<p>Neste exercício, você vai trabalhar em uma aplicação semelhante, porém simplificada: um classificador binário usando o perceptron de Rosenblatt para classificar imagens de círculos ou quadrados.</p>
<p>Antes de começar a trabalhar no código, certifique-se de ter baixado o <a href="https://media.githubusercontent.com/media/psi3471/datasets/main/circles_vs_rects_dataset/circles_and_squares.csv">arquivo CSV com os dados</a> do repositório de materiais.</p>
<p>Para carregar o arquivo CSV e processar os dados, você pode usar a biblioteca <a href="https://pandas.pydata.org/">Pandas</a>. Após a instalação da biblioteca e o download do arquivo CSV, é possível carregar os dados com os seguintes comandos:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="https://psi3471.github.io/ex_entrega_2.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="https://psi3471.github.io/ex_entrega_2.html#cb1-2" aria-hidden="true" tabindex="-1"></a>data_df <span class="op">=</span> pd.read_csv(<span class="st">"circles_and_squares.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Com esses comandos, você vai criar um <em>DataFrame</em> do Pandas chamado <code>data_df</code> contendo os dados do arquivo CSV. Para ver algumas linhas do <em>DataFrame</em>, você pode usar o método <code>.head()</code>:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="https://psi3471.github.io/ex_entrega_2.html#cb2-1" aria-hidden="true" tabindex="-1"></a>data_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">391</th>
<th data-quarto-table-cell-role="th">392</th>
<th data-quarto-table-cell-role="th">393</th>
<th data-quarto-table-cell-role="th">394</th>
<th data-quarto-table-cell-role="th">395</th>
<th data-quarto-table-cell-role="th">396</th>
<th data-quarto-table-cell-role="th">397</th>
<th data-quarto-table-cell-role="th">398</th>
<th data-quarto-table-cell-role="th">399</th>
<th data-quarto-table-cell-role="th">400</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>-1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>-1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>-1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>-1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 401 columns</p>
</div>
</div>
</div>
<p>É possível converter o <em>DataFrame</em> em um <em>array</em> NumPy usando o método <code>.to_numpy()</code>:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="https://psi3471.github.io/ex_entrega_2.html#cb3-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data_df.to_numpy()</span>
<span id="cb3-2"><a href="https://psi3471.github.io/ex_entrega_2.html#cb3-2" aria-hidden="true" tabindex="-1"></a>data_df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>(1000, 401)</code></pre>
</div>
</div>
<p>A matriz de dados tem 1000 linhas e 401 colunas. Cada linha se refere a um exemplo no banco de dados. As 400 primeiras colunas se referem aos elementos de uma matriz 20x20 com os dados referentes à digitalização de uma imagem de um círculo ou de um quadrado. A última coluna é um rótulo igual a -1 ou 1 indicando se a imagem se refere a um círculo ou a um quadrado.</p>
<p>Você pode visualizar uma imagem, usando o método <code>.reshape()</code> para reorganizar os 400 coeficientes em uma matriz 20x20 e a função <code>imshow()</code> para exibí-la. Por exemplo, para exibir a imagem referente à primeira linha da matriz:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="https://psi3471.github.io/ex_entrega_2.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-2"><a href="https://psi3471.github.io/ex_entrega_2.html#cb5-2" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> data[<span class="dv">0</span>, :<span class="op">-</span><span class="dv">1</span>].reshape((<span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb5-3"><a href="https://psi3471.github.io/ex_entrega_2.html#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.imshow(img, cmap<span class="op">=</span><span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f0127f3fd60&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/cell-7-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>O rótulo referente à imagem pode ser obtido com o elemento da última coluna:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="https://psi3471.github.io/ex_entrega_2.html#cb7-1" aria-hidden="true" tabindex="-1"></a>data[<span class="dv">0</span>, <span class="dv">400</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>-1.0</code></pre>
</div>
</div>
<p>Como você pode observar, o rótulo igual a -1 é usado para identificar os círculos. Além disso, vale notar também que a resolução de 20x20 considerada na digitalização da figura do círculo causa uma distorção considerável. No entanto, vamos utilizar essa resolução baixa para reduzir a dimensionalidade do problema e tornar o treinamento mais rápido.</p>
<p>A quinta linha da matriz (índice 4) representa um quadrado:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="https://psi3471.github.io/ex_entrega_2.html#cb9-1" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> data[<span class="dv">4</span>, :<span class="op">-</span><span class="dv">1</span>].reshape((<span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb9-2"><a href="https://psi3471.github.io/ex_entrega_2.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[<span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb9-3"><a href="https://psi3471.github.io/ex_entrega_2.html#cb9-3" aria-hidden="true" tabindex="-1"></a>plt.imshow(img, cmap<span class="op">=</span><span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.0</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f0127dd3d00&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="./Enunciado - Exercício 2 - Perceptron de Rosenblatt_files/cell-9-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>No exercício, você vai utilizar as 800 primeiras linhas do banco de dados para fazer o treinamento do perceptron, ajustando os valores dos pesos de forma iterativa e as 200 linhas finais para avaliar o desempenho do seu modelo na classificação de círculos e quadrados. Dessa forma, você pode separar os dados em uma matriz <code>Xd</code> para o treinamento e <code>Xd_test</code> para o teste:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="https://psi3471.github.io/ex_entrega_2.html#cb12-1" aria-hidden="true" tabindex="-1"></a>Xd <span class="op">=</span> data[:<span class="dv">800</span>, :]</span>
<span id="cb12-2"><a href="https://psi3471.github.io/ex_entrega_2.html#cb12-2" aria-hidden="true" tabindex="-1"></a>Xd_test <span class="op">=</span> data[<span class="dv">800</span>:, :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Você deve implementar uma função para treinar o perceptron de Rosenblatt de forma iterativa, dados a matriz <code>Xd</code>, um passo de adaptação <code>eta</code>, o número de épocas <code>Ne</code> e o tamanho do <em>mini-batch</em> <code>Nb</code>. Após o treinamento, avalie o seu modelo com os dados dos conjuntos de treinamento e de teste, medindo a acurácia do classificador para ambos os casos. A escolha desses hiperparâmetros fica a seu critério, buscando obter um bom desempenho com os dados de teste.</p>
<p>Ao final do exercício, você deverá apresentar:</p>
<ol type="1">
<li><p>Os códigos utilizados para treinar o modelo e avaliá-lo com os conjuntos de treinamento e de teste;</p></li>
<li><p>O valor obtido para a acurácia considerando os dados de teste.</p></li>
</ol>
<p>A sugestão é que o relatório seja elaborado utilizando um Jupyter Notebook e a linguagem Python, já que essas são as ferramentas que estamos utilizando neste bloco do curso. No entanto, isso não é obrigatório e você pode usar outra linguagem de programação, caso queira.</p>
<section id="instruções-para-entrega" class="level2">
<h2 class="anchored" data-anchor-id="instruções-para-entrega">Instruções para entrega<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://psi3471.github.io/ex_entrega_2.html#instru%C3%A7%C3%B5es-para-entrega" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><p>O exercício pode ser feito em dupla ou individualmente;</p></li>
<li><p>A entrega deve incluir:</p>
<ul>
<li>Um vídeo de no <strong>máximo 40s</strong>, mostrando a resolução do exercício;</li>
<li>Os <strong>códigos-fontes</strong> dos programas, preferencialmente organizados em um Jupyter Notebook, descrevendo o experimento e mostrando como foram obtidos os resultados solicitados.</li>
</ul></li>
<li><p><strong>A correção será feita baseada no vídeo</strong>. Quando o professor/pesquisador ficar com alguma dúvida, serão consultados os códigos-fonte;</p></li>
<li><p>Sobre o vídeo:</p>
<ul>
<li><strong>Deve incluir áudio</strong> descrevendo o experimento;</li>
<li>Gravem a tela do computador usando celular ou usando algum programa de captura de tela (por exemplo Zoom, Google Meet, ou OBS Studio);</li>
<li>No início, <strong>deve aparecer o rosto e algum documento do aluno que gravou o vídeo</strong> (como a carteira USP, RG, CNH, etc);</li>
<li>No caso de entrega em dupla, <strong>não é necessário que os dois componentes apareçam no vídeo</strong>. No entanto, alternem o apresentador ao longo das entregas dos exercícios e <strong>não esqueçam de incluir os dois nomes no início do vídeo</strong>.</li>
<li>Procurem convencer o espectador do vídeo, que vai corrigir o exercício que fizeram os exercícios computacionais solicitados e que eles estão funcionando corretamente. Tentem fazer um bom aproveitamento do tempo para apresentar os resultados solicitados, <strong>respeitando o limite de 40s e não acelerem a velocidade do vídeo</strong>;</li>
</ul></li>
<li><p>Sobre os códigos-fonte:</p>
<ul>
<li><strong>Incluir o nome do(s) aluno(s)</strong> no início do programa;</li>
</ul></li>
<li><p>Sobre o envio no Moodle:</p>
<ul>
<li>Apenas um aluno de cada dupla deve enviar o vídeo no Moodle;</li>
<li>Podem ser enviados o arquivo de vídeo (.mkv, .mp4, .avi, etc.) ou um link para o vídeo (Youtube, Google Drive, etc);
<ul>
<li>No segundo caso, certifiquem-se que todos os professores/pesquisadores (magno.silva@usp.br, hae.kim@usp.br, renatocan@lps.usp.br, wesleybeccaro@usp.br) tenham acesso ao seu vídeo.</li>
</ul></li>
<li>Não se esqueçam de escrever o nome dos componentes da dupla (ou do único aluno, escrevendo: “exercício feito individualmente”) em três lugares diferentes: <strong>no campo “comentários sobre o envio” no Moodle</strong>, <strong>no início do vídeo</strong> e no <strong>início dos códigos-fonte</strong>.</li>
</ul></li>
</ul>
</section>
</div>



</main> <!-- /main -->
<script>
var custom_title = document.querySelectorAll('.custom .theorem-title');

for (let i = 0; i < custom_title.length; i++ ) {
   var mod_name = custom_title[i].innerHTML;
   custom_title[i].innerHTML = mod_name.replace("Exemplo", "Algoritmo");
};
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>